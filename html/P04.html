<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>마이 프로필 수정 - 딸기마켓</title>
  <link rel="stylesheet" href="../css/default.css">
</head>

<body>
  <div class="nav-skip">
    <a href="#gnb">메뉴 바로가기</a>
    <a href="#content">본문 바로가기</a>
  </div>
  <header class="nav nav-upload container">
    <button type="button" class="btn-back"><img src="../assets/icon/icon-arrow-left.png" alt="뒤로가기"></button>
    <button type="button" class="save-btn" disabled>저장</button>
  </header>
  <main>
    <section class="container">
      <h1 class="sr-only">마이 프로필 수정</h1>
      <!-- TODO:: api 확인 -->
      <div class="profile-edit-wrap">
        <button type="button" class="profile-btn-upload"><img src="../assets/upload-file.png"
            alt="프로필 이미지 업로드 버튼입니다."></button>
      </div>

      <form class="profile-edit-form">
        <!-- <input type="hidden" id="editImg" value=""> -->
        <input class="sr-only" id="editImg" type="file" accept="image/*" />

        <label for="editName" class="edit-name-tit">사용자 이름</label>
        <input type="text" minlength="2" maxlength="10" class="edit-name-input" id="editName" required
          placeholder="2~10자 이내여야 합니다.">
        <strong class="edit-message-error name">*2~10자 이내여야 합니다.</strong>

        <label for="editId" class="edit-id-tit">계정 ID</label>
        <input type="text" class="edit-id-input" id="editId" required placeholder="영문, 숫자, 특수문자(.),(_)만 사용 가능합니다.">
        <strong class="edit-message-error id">*영문, 숫자, 특수문자(.),(_)만 사용 가능합니다..</strong>

        <label for="editIntro" class="edit-intro-tit">소개</label>
        <input type="text" maxlength="50" class="edit-intro-input" id="editIntro" required
          placeholder="자신과 판매할 상품에 대해 소개해 주세요!">
        <strong class="edit-message-error intro">*최대 50자 입력 가능합니다.</strong>
      </form>
    </section>
  </main>

  <script src="../js/script.js"></script>
  <script src="../js/script_NR.js"></script>
  <script>
    const saveBtn = document.querySelector('.save-btn');
    const imgUploadBtn = document.querySelector('.profile-btn-upload');
    const editForm = document.querySelector('.profile-edit-form');
    const editImg = document.querySelector('#editImg');
    const editName = document.querySelector('.edit-name-input');
    const editId = document.querySelector('.edit-id-input');
    const editIntro = document.querySelector('.edit-intro-input');

    // 버튼 클릭시 이미지 input 버튼 클릭
    imgUploadBtn.addEventListener('click', function (e) {
      editImg.click();
    });

    // 이미지 배경 설정 background image url render function
    let readURL = function (input) {
      if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
          document.querySelector('.profile-edit-wrap').style.background = `url(${e.target.result}) center center / cover`;
        }
        reader.readAsDataURL(input.files[0]);
      }
    }
    editImg.addEventListener('change', function (e) {
      readURL(this);
    });

    // 모든 input 입력되면 저장 버튼 활성화
    editForm.addEventListener('input', function (e) {
      if ((editImg.value !== '') && (editName.value !== '') && (editId.value !== '') && (editIntro.value !== '')) {
        saveBtn.disabled = false;
      } else {
        saveBtn.disabled = true;
      }
    });

    // 사용자 이름 유효성 검사
    editName.addEventListener('input', function (e) {
      const messageError = document.querySelector('.edit-message-error.name');
      if (e.target.value.length == 11 || e.target.value.length < 2) {
        messageError.style.display = 'block';
      } else {
        messageError.style.display = 'none';
      }
    });

    // 계정 ID 유효성 검사
    editId.addEventListener('input', function (e) {
      const messageError = document.querySelector('.edit-message-error.id');
      const regExp = new RegExp('^[a-z0-9._]*$');
      if (!regExp.test(e.target.value)) {
        messageError.style.display = 'block';
      } else {
        messageError.style.display = 'none';
      }
    });

    // 소개 길이 유효성 검사
    editIntro.addEventListener('input', function (e) {
      const messageError = document.querySelector('.edit-message-error.intro');
      if (e.target.value.length == 50) {
        messageError.style.display = 'block';
      } else {
        messageError.style.display = 'none';
      }
    });
  </script>
</body>

</html>